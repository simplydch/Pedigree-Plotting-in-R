<html>

<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Plotting Pedigrees in R is Suprisingly Easy </title><h1>Plotting Pedigrees in R is Suprisingly Easy</h1>
<h2>(Even without ggplot)</h2>
</head>

<body>

<p>This is my first attempt at a tutorial, I don't know if anyone will find it useful, but perhaps someone will stubble accross it and find it interesting.</p>

<p>I've always been a little overwhelmed by packages that plot pedigrees, they always seem to have hundreds of lines of code and it always seemed like a very involved process to be able to go from a huge pedigree to such a complicated diagram.</p>

<p>However, as I've become more familiar with R the the mystery behind plotting a pedigree has slowly went away. The truth is that plotting a pedigree is easy, really easy.</p>

<p>I'd argue that in terms of quickly visualising your data, this will be as quick as loading up a package and getting your pedigree into the correct format.</p>

<p>Additional files can be found at 
<a href="https://github.com/simplydch/Pedigree-Plotting-in-R">github.com/simplydch/Pedigree-Plotting-in-R</a></p.

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## To demostrated here is a small simulated pedigree consisting of 136 indivdiuals</span>
<span class="hl com"># in 10 cohorts:</span>

<span class="hl kwd">load</span><span class="hl std">(</span><span class="hl str">&quot;short_ped.RData&quot;</span><span class="hl std">)</span>
<span class="hl kwd">head</span><span class="hl std">(short_ped)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    ID Sex Gen SireID MumID Status Died Cohort Arrived
## 1 ID1   1   1   &lt;NA&gt;  &lt;NA&gt;      d    9   2000      NA
## 2 ID2   1   1   &lt;NA&gt;  &lt;NA&gt;      d    2   2000      NA
## 3 ID3   1   1   &lt;NA&gt;  &lt;NA&gt;      d    3   2000      NA
## 4 ID4   1   1   &lt;NA&gt;  &lt;NA&gt;      d    4   2000      NA
## 5 ID5   1   1   &lt;NA&gt;  &lt;NA&gt;      d    6   2000      NA
## 6 ID6   1   1   &lt;NA&gt;  &lt;NA&gt;      d    3   2000      NA
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">dim</span><span class="hl std">(short_ped)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 136   9
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## To start we need to take the Cohorts from the pedigree to provide our y-axis values</span>
<span class="hl std">y</span><span class="hl kwb">&lt;-</span><span class="hl std">short_ped[,</span><span class="hl str">'Cohort'</span><span class="hl std">]</span>
<span class="hl com">## We then need x-coordinates that spread each set of cohorts out evenly across the x-axis</span>
<span class="hl com">## First we can use table to find how many individuals are in each cohort</span>
<span class="hl com">## For each of these values we generate an evenly spaced sequence between 1 and 10 </span>
<span class="hl com">## The output of sapply is a list, so I use do.call to join the values</span>
<span class="hl com">## into a single vector</span>
<span class="hl std">y_counts</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">unname</span><span class="hl std">(</span><span class="hl kwd">table</span><span class="hl std">(y))</span>
<span class="hl std">x</span><span class="hl kwb">&lt;-</span><span class="hl kwd">do.call</span><span class="hl std">(c,</span><span class="hl kwd">sapply</span><span class="hl std">(y_counts,</span><span class="hl kwa">function</span> <span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">)</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">10</span><span class="hl std">,</span><span class="hl kwc">length</span><span class="hl std">=x)))</span>

<span class="hl com"># And we can have our first attempt at plotting</span>
<span class="hl kwd">plot</span><span class="hl std">(x,y)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-1-1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" class="plot" /></div></div>

<p>So we have every individual represented as a dot in the line that relates to their cohort</p>

<p>Now we need to join those dots, using the under-appreciated, but incredibly useful match function!</p>

<p>This allows us to find the row reference of the sire that relates to each id.
If we re-arrange the order of the plotted x and y values using these references that's all the information needed to plot all the sire links using the segments function</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## Lets first of all pull the ids, sires and dams from the pedigree</span>
<span class="hl std">ids</span> <span class="hl kwb">&lt;-</span> <span class="hl std">short_ped[,</span><span class="hl str">'ID'</span><span class="hl std">]</span>
<span class="hl std">sires</span> <span class="hl kwb">&lt;-</span><span class="hl std">short_ped[,</span><span class="hl str">'SireID'</span><span class="hl std">]</span>
<span class="hl std">dams</span> <span class="hl kwb">&lt;-</span><span class="hl std">short_ped[,</span><span class="hl str">'MumID'</span><span class="hl std">]</span>

<span class="hl std">sire_ref</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">match</span><span class="hl std">(sires, ids)</span>

<span class="hl std">x_sire</span><span class="hl kwb">&lt;-</span><span class="hl std">x[sire_ref]</span>
<span class="hl std">y_sire</span><span class="hl kwb">&lt;-</span><span class="hl std">y[sire_ref]</span>

<span class="hl com"># Segments creates lines between the points in the provided x and y - values</span>
<span class="hl kwd">plot</span><span class="hl std">(x,y)</span>
<span class="hl kwd">segments</span><span class="hl std">(x, y , x_sire, y_sire)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-2-1.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" class="plot" /></div></div>

<p>An obvious question is why there are individuals at the bottom of the plot that, have no sire links.  Well, out plot is currently upside down.  Those must be the female founders!<p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Lets rearrange the plot</span>

<span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">ylim</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(y),</span> <span class="hl kwd">min</span><span class="hl std">(y)))</span>

<span class="hl com"># And add those sire links, this time, lets make them orange</span>

<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire,y_sire,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'orange'</span><span class="hl std">)</span>

<span class="hl com"># And we can then add in the dams</span>

<span class="hl std">dam_ref</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">match</span><span class="hl std">(dams, ids)</span>

<span class="hl std">x_dam</span><span class="hl kwb">&lt;-</span><span class="hl std">x[dam_ref]</span>
<span class="hl std">y_dam</span><span class="hl kwb">&lt;-</span><span class="hl std">y[dam_ref]</span>

<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam,y_dam,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'blue'</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># And that's it!  </span>

<span class="hl com">#We probably want to change a few settings to make the plot neater</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mar</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl num">4</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">))</span>
<span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">ylim</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(y),</span><span class="hl kwd">min</span><span class="hl std">(y)),</span><span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">),</span> <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl str">'.'</span><span class="hl std">,</span> <span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl kwc">frame.plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">,</span> <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">,</span> <span class="hl kwc">axes</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl com">## And probably add in the Cohort information</span>
<span class="hl kwd">axis</span><span class="hl std">(</span><span class="hl kwc">side</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">labels</span><span class="hl std">=</span><span class="hl num">TRUE</span> <span class="hl std">,</span><span class="hl kwc">tick</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">las</span><span class="hl std">=</span><span class="hl num">2</span> <span class="hl std">,</span> <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">unique</span><span class="hl std">(y))</span>

<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire,y_sire,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'orange'</span><span class="hl std">)</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam,y_dam,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'blue'</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-3-2.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" class="plot" /></div></div>

<p>It really is that quick and easy.  If you wish to only plot some links, for example the descendants of one individual, things become slightly  more challenging.  However, you have all your links already, you just need to figure out which ones to 'turn on'.</p>

<p>Let's take it to the next stage and plot all the offspring of individual ID4<p>

<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Lets start with the background pedigree, we can specify the colours as rgb </span>
<span class="hl com"># and make them grey and transparent</span>
<span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">ylim</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(y),</span><span class="hl kwd">min</span><span class="hl std">(y)),</span><span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">),</span> <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl str">'.'</span><span class="hl std">,</span> <span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span>
<span class="hl kwc">frame.plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">axes</span><span class="hl std">=F,</span> <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">,</span> <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span><span class="hl kwc">side</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">labels</span><span class="hl std">=</span><span class="hl num">TRUE</span> <span class="hl std">,</span><span class="hl kwc">tick</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">las</span><span class="hl std">=</span><span class="hl num">2</span> <span class="hl std">,</span> <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">unique</span><span class="hl std">(y))</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire,y_sire,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam,y_dam,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>



<span class="hl com"># Plotting just the immediate offspring isn't hard</span>

<span class="hl com"># Lets plot the focal id using points first</span>
<span class="hl std">id_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">which</span><span class="hl std">(ids</span> <span class="hl opt">%in%</span> <span class="hl str">'ID4'</span><span class="hl std">)</span>

<span class="hl kwd">points</span><span class="hl std">(x[id_plot],y[id_plot],</span> <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">'red'</span><span class="hl std">)</span>

<span class="hl com"># And then his offspring, </span>

<span class="hl std">ID_wSire</span><span class="hl kwb">&lt;-</span><span class="hl kwd">which</span><span class="hl std">(sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">id_plot)</span>

<span class="hl kwd">points</span><span class="hl std">(x[ID_wSire],y[ID_wSire])</span>

<span class="hl com"># So to plot the links, lets just turn off all the links that aren't connected to individual ID4. Since he is a sire we only have to plot sire links</span>

<span class="hl std">x_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">x_sire</span>
<span class="hl std">y_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">y_sire</span>
<span class="hl std">x_sire2[sire_ref</span><span class="hl opt">!=</span><span class="hl std">id_plot]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl std">y_sire2[sire_ref</span><span class="hl opt">!=</span><span class="hl std">id_plot]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire2,y_sire2,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'orange'</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div></div>

<p>The next stage is a bit harder still. How to we plot all descendants? Unsurprisingly it requires a few more steps and a little more thinking.</p>

<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## Lets start again with a plain background</span>

<span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">ylim</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(y),</span><span class="hl kwd">min</span><span class="hl std">(y)),</span><span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">),</span> <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl str">'.'</span><span class="hl std">,</span> <span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span>
     <span class="hl kwc">frame.plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">axes</span><span class="hl std">=F,</span> <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">,</span> <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span><span class="hl kwc">side</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">labels</span><span class="hl std">=</span><span class="hl num">TRUE</span> <span class="hl std">,</span><span class="hl kwc">tick</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">las</span><span class="hl std">=</span><span class="hl num">2</span> <span class="hl std">,</span> <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">unique</span><span class="hl std">(y))</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire,y_sire,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam,y_dam,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>


<span class="hl com"># The main hurdle is identifying all the descendants in the first place, so we'll use</span>
<span class="hl com"># a basic little loop</span>

<span class="hl com">#  We set up vectors to hold the parents each iteration and also all the descendants</span>
<span class="hl com"># our focal indivdiual goes into both.  At each iteration of the loop we find all the</span>
<span class="hl com"># indivdiuals that are offspring of the parents, and continue until there are no offspring.</span>

<span class="hl std">parents</span> <span class="hl kwb">&lt;-</span> <span class="hl std">id_plot</span>
<span class="hl std">desc_ref</span> <span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(id_plot)</span>

<span class="hl kwa">repeat</span><span class="hl std">{</span>
<span class="hl std">offspring</span><span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(ids[sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">parents],ids[dam_ref</span> <span class="hl opt">%in%</span> <span class="hl std">parents])</span>
<span class="hl std">off_ref</span><span class="hl kwb">&lt;-</span><span class="hl kwd">which</span><span class="hl std">(ids</span> <span class="hl opt">%in%</span> <span class="hl std">offspring)</span>
<span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(offspring)</span> <span class="hl opt">==</span><span class="hl num">0</span><span class="hl std">){</span><span class="hl kwa">break</span><span class="hl std">}</span>
<span class="hl std">desc_ref</span><span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(desc_ref, off_ref)</span>
<span class="hl std">parents</span><span class="hl kwb">&lt;-</span><span class="hl std">off_ref</span>
<span class="hl std">}</span>

<span class="hl com">#</span>
<span class="hl com"># We have now got all the relevant individual references</span>
<span class="hl std">desc_ref</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1]   4  32  35  42  45  48  54  56  58  67  71  72  81  52  75  78  79  87  88
## [20]  89  90  91  92  93  95  97 101 104  94  96  98  99 100 102 103 106 107 109
## [39] 110 111 112 115 117 118 120 122 123 126 128 130 131 132 133 136 101 108 109
## [58] 110 113 114 116 119 121 124 125 126 127 129 130 131 133 134 136 110 118
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># So again we can highlight the focal individual and all it's descendants</span>

<span class="hl kwd">points</span><span class="hl std">(x[desc_ref],y[desc_ref])</span>
<span class="hl kwd">points</span><span class="hl std">(x[id_plot],y[id_plot],</span> <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">'red'</span><span class="hl std">)</span>

<span class="hl com"># This time we are interestd in plotting both sire and dam links, but only to other</span>
<span class="hl com"># individuals in the list of descendents we have generated.</span>

<span class="hl std">x_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">x_sire</span>
<span class="hl std">y_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">y_sire</span>
<span class="hl std">x_sire2[</span><span class="hl opt">!</span><span class="hl std">(sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl std">y_sire2[</span><span class="hl opt">!</span><span class="hl std">(sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire2,y_sire2,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'orange'</span><span class="hl std">)</span>


<span class="hl std">x_dam2</span><span class="hl kwb">&lt;-</span><span class="hl std">x_dam</span>
<span class="hl std">y_dam2</span><span class="hl kwb">&lt;-</span><span class="hl std">y_dam</span>
<span class="hl std">x_dam2[</span><span class="hl opt">!</span><span class="hl std">(dam_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl std">y_dam2[</span><span class="hl opt">!</span><span class="hl std">(dam_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam2,y_dam2,</span> <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'blue'</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" class="plot" /></div></div>

<p>
In conlusion, I maybe lied a little about how simple it is but actually plotting a whole pedigree really is that simple.  The key challenge is subsetting the lines to just the ones that you want.  There is one other cheat, because 

<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## Lets start again with a plain background</span>

<span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">ylim</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl kwd">max</span><span class="hl std">(y),</span><span class="hl kwd">min</span><span class="hl std">(y)),</span><span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">),</span> <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl str">'.'</span><span class="hl std">,</span> <span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span>
     <span class="hl kwc">frame.plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">axes</span><span class="hl std">=F,</span> <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">,</span> <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">''</span><span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span><span class="hl kwc">side</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">labels</span><span class="hl std">=</span><span class="hl num">TRUE</span> <span class="hl std">,</span><span class="hl kwc">tick</span><span class="hl std">=</span><span class="hl num">FALSE</span><span class="hl std">,</span> <span class="hl kwc">las</span><span class="hl std">=</span><span class="hl num">2</span> <span class="hl std">,</span> <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">unique</span><span class="hl std">(y),</span> <span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">0.8</span><span class="hl std">)</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire,y_sire,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam,y_dam,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">))</span>


<span class="hl std">x_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">x_sire</span>
<span class="hl std">y_sire2</span><span class="hl kwb">&lt;-</span><span class="hl std">y_sire</span>
<span class="hl std">x_sire2[</span><span class="hl opt">!</span><span class="hl std">(sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl std">y_sire2[</span><span class="hl opt">!</span><span class="hl std">(sire_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_sire2,y_sire2,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.8</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">,</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl num">0.7</span><span class="hl std">))</span>


<span class="hl std">x_dam2</span><span class="hl kwb">&lt;-</span><span class="hl std">x_dam</span>
<span class="hl std">y_dam2</span><span class="hl kwb">&lt;-</span><span class="hl std">y_dam</span>
<span class="hl std">x_dam2[</span><span class="hl opt">!</span><span class="hl std">(dam_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl std">y_dam2[</span><span class="hl opt">!</span><span class="hl std">(dam_ref</span> <span class="hl opt">%in%</span> <span class="hl std">desc_ref</span> <span class="hl opt">&amp;</span> <span class="hl std">ids</span> <span class="hl opt">%in%</span> <span class="hl std">ids[desc_ref])]</span><span class="hl kwb">&lt;-</span><span class="hl num">NA</span>
<span class="hl kwd">segments</span><span class="hl std">(x,y,x_dam2,y_dam2,</span> <span class="hl kwc">col</span><span class="hl std">=</span> <span class="hl kwd">rgb</span><span class="hl std">(</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl num">0.6</span><span class="hl std">,</span><span class="hl num">0.8</span><span class="hl std">,</span><span class="hl num">0.7</span><span class="hl std">))</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-6-1.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" class="plot" /></div></div>


</body>
</html>
